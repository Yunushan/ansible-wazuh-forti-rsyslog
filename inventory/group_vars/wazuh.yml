# Example overrides for the wazuh group.
# Copy/edit these values for your environment.

# --- Connection (optional, avoids prompts) ---
# ansible_user: ansible
# ansible_ssh_private_key_file: /root/.ssh/id_ed25519
# ansible_become: true
# ansible_become_method: sudo
# ansible_become_pass: "{{ vault_become_pass }}"

# --- Syslog listener ---
forti_syslog_enable_udp: true
forti_syslog_enable_tcp: false
forti_syslog_udp_port: 514
forti_syslog_tcp_port: 5514
forti_syslog_listen_address: ""   # bind all interfaces

# Restrict senders (optional). Leave empty to accept from anywhere.
forti_syslog_allowed_senders: []

# --- Storage paths ---
forti_log_dir: /var/log/fortinet
forti_log_filename: fortigate.log
# forti_log_owner: syslog
# forti_log_group: wazuh
# forti_log_file_mode: "0644"

# --- Retention ---
forti_logrotate_frequency: daily
forti_log_retention_days: 1
# Avoid truncating active logs so Wazuh can catch up after rotation.
forti_logrotate_copytruncate: false

# --- Performance tuning (select mode) ---
forti_tuning_mode: "full"  # 0/full=all logs, 1=source_filter, 2=split_traffic, 3=wazuh_light, auto=detect
# forti_syslog_traffic_patterns:
#   - "type=traffic"
# forti_traffic_log_filename: fortigate-traffic.log
# forti_traffic_filebeat_manage: null

# --- Backfill (optional) ---
# forti_backfill_enable: true  # optional; auto if all values are set
# forti_backfill_source_path: /var/log/fortinet/fortigate.log-20260108
# forti_backfill_output_path: /var/log/fortinet/fortigate.backfill-20260107-1500_20260108-0200.log
# forti_backfill_start: "2026-01-07 15:00:00"
# forti_backfill_end: "2026-01-08 02:00:00"
# forti_backfill_manage_localfile: true
# forti_backfill_cleanup_localfile: false
# forti_backfill_cleanup_file: false

# --- Wazuh archives rotation (optional) ---
# forti_wazuh_archives_logrotate_manage: true
# forti_wazuh_archives_logrotate_conf_path: /etc/logrotate.d/wazuh-archives
# forti_wazuh_archives_log_path: /var/ossec/logs/archives/archives.json
# forti_wazuh_archives_log_retention_days: 7

# --- Wazuh integration ---
forti_wazuh_manage: true
forti_wazuh_ossec_conf_path: /var/ossec/etc/ossec.conf
forti_wazuh_manager_service_name: wazuh-manager
forti_wazuh_log_format: syslog
forti_wazuh_manage_logall: true
forti_wazuh_logall: "yes"
forti_wazuh_manage_logall_json: true
forti_wazuh_logall_json: "yes"

# --- Wazuh manager tuning (optional) ---
# forti_wazuh_tuning_manage: null
# forti_wazuh_disable_modules:
#   - vulnerability-detector
#   - syscollector
# forti_wazuh_ruleset_manage: null
# forti_wazuh_ruleset_rule_excludes:
#   - 1002
# forti_wazuh_ruleset_decoder_excludes:
#   - syslog
# forti_wazuh_ruleset_exclude_forti: true
# forti_wazuh_ruleset_exclude_forti_patterns:
#   - "*fortigate*"
#   - "*fortinet*"
# forti_wazuh_root: /var/ossec
# forti_wazuh_ruleset_dirs:
#   - "{{ forti_wazuh_root }}/ruleset/rules"
#   - "{{ forti_wazuh_root }}/etc/rules"
# Fortinet alert mapping (default uses Fortinet severity level)
forti_wazuh_fortinet_alerts_use_fortinet_level: true
# Default mapping includes only high/critical (emergency/alert/critical).
# Optional: include lower severities by overriding forti_wazuh_fortinet_alerts_level_map

# To use Fortinet criticality (crlevel=high/critical) instead:
# forti_wazuh_fortinet_alerts_use_fortinet_level: false
# forti_wazuh_fortinet_alerts_match_field: crlevel
# forti_wazuh_fortinet_alerts_map:
#   - match: high
#     level: 12
#   - match: critical
#     level: 15

# --- Fortinet SSL VPN login failures (thresholded alert) ---
# forti_wazuh_ssl_vpn_fail_manage: true
# forti_wazuh_ssl_vpn_fail_frequency: 5
# forti_wazuh_ssl_vpn_fail_timeframe: 300
# forti_wazuh_ssl_vpn_fail_same_field: dstuser
# forti_wazuh_ssl_vpn_fail_level: 14
# forti_wazuh_ssl_vpn_fail_match:
#   - 'action=ssl-login-fail'
#   - 'logdesc="SSL VPN login fail"'

# --- Email alerts (custom SMTP integration) ---
# forti_wazuh_email_integration_manage: true
# forti_wazuh_email_from: wazuh@example.com
# forti_wazuh_email_to:
#   - soc@example.com
# forti_wazuh_email_smtp_server: smtp.example.com
# forti_wazuh_email_smtp_port: 587
# forti_wazuh_email_smtp_user: wazuh@example.com
# forti_wazuh_email_smtp_password: "{{ vault_smtp_password }}"
# forti_wazuh_email_smtp_protocol: starttls
# forti_wazuh_email_integration_alert_levels: [12, 15]

# --- Filebeat archives shipping (optional) ---
forti_wazuh_filebeat_manage: true
forti_wazuh_filebeat_archives_enabled: true
# forti_wazuh_filebeat_config_path: /etc/filebeat/filebeat.yml
# forti_wazuh_filebeat_inputs_manage: true
# forti_wazuh_filebeat_inputs_dir: /etc/filebeat/inputs.d
# forti_wazuh_filebeat_inputs_file: /etc/filebeat/inputs.d/wazuh-archives.yml
# forti_wazuh_filebeat_inputs_glob: /etc/filebeat/inputs.d/*.yml
# forti_wazuh_filebeat_inputs_reload: false
# forti_wazuh_filebeat_input_type: log
# forti_wazuh_archives_clear_severity: true   # set false to keep rule.level
forti_wazuh_archives_severity_mode: drop    # drop | zero | keep
# forti_wazuh_archives_include_severity: null # legacy override
# forti_wazuh_filebeat_archives_paths:
#   - /var/ossec/logs/archives/archives.json
# forti_wazuh_archives_pipeline_manage: false
# forti_wazuh_opensearch_url: https://127.0.0.1:9200
# forti_wazuh_opensearch_auth_method: basic
# forti_wazuh_opensearch_username: admin
# forti_wazuh_opensearch_password: "{{ vault_opensearch_password }}"
# forti_wazuh_opensearch_validate_certs: false
# forti_wazuh_archives_pipeline_name: filebeat-7.10.2-wazuh-archives-pipeline

# --- Filebeat performance tuning (optional) ---
# forti_wazuh_filebeat_tuning_manage: true
# forti_wazuh_filebeat_tuning_output_worker: 2
# forti_wazuh_filebeat_tuning_output_bulk_max_size: 2048
# forti_wazuh_filebeat_tuning_output_compression_level: 0
# forti_wazuh_filebeat_tuning_queue_events: 4096
# forti_wazuh_filebeat_tuning_queue_flush_min_events: 2048
# forti_wazuh_filebeat_tuning_queue_flush_timeout: "1s"

# --- Dashboards index pattern (optional) ---
# forti_wazuh_dashboards_manage: true
# forti_wazuh_dashboards_url: https://wazuh.example.com
# forti_wazuh_dashboards_auth_method: basic
# forti_wazuh_dashboards_username: admin
# forti_wazuh_dashboards_password: "{{ vault_dashboards_password }}"
# forti_wazuh_dashboards_version: "2.x"
# forti_wazuh_dashboards_validate_certs: false
# forti_wazuh_dashboards_timezone: Etc/GMT-3
# forti_wazuh_dashboards_tenant: global
# forti_wazuh_dashboards_archives_pattern: wazuh-archives-*
# forti_wazuh_dashboards_archives_time_field: timestamp
