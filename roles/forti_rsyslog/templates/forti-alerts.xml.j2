<!-- Ansible managed: Fortinet high/critical alerts -->
<group name="fortinet,">
{% if forti_wazuh_fortinet_alerts_map | length > 0 %}
{% for item in forti_wazuh_fortinet_alerts_map %}
  <rule id="{{ (forti_wazuh_fortinet_alerts_rule_id_base | int) + (loop.index0 * 2) }}" level="{{ item.level | int }}">
    <match>{{ forti_wazuh_fortinet_alerts_match_field }}={{ item.match | string }}</match>
    <description>Fortinet alert level {{ item.level | int }}</description>
  </rule>
  <rule id="{{ (forti_wazuh_fortinet_alerts_rule_id_base | int) + (loop.index0 * 2) + 1 }}" level="{{ item.level | int }}">
    <match>{{ forti_wazuh_fortinet_alerts_match_field }}="{{ item.match | string }}"</match>
    <description>Fortinet alert level {{ item.level | int }}</description>
  </rule>
{% endfor %}
{% else %}
{% for level in forti_wazuh_fortinet_alerts_levels_effective %}
  <rule id="{{ (forti_wazuh_fortinet_alerts_rule_id_base | int) + (loop.index0 * 2) }}" level="{{ level | int }}">
    <match>{{ forti_wazuh_fortinet_alerts_match_field }}={{ level }}</match>
    <description>Fortinet alert level {{ level | int }}</description>
  </rule>
  <rule id="{{ (forti_wazuh_fortinet_alerts_rule_id_base | int) + (loop.index0 * 2) + 1 }}" level="{{ level | int }}">
    <match>{{ forti_wazuh_fortinet_alerts_match_field }}="{{ level }}"</match>
    <description>Fortinet alert level {{ level | int }}</description>
  </rule>
{% endfor %}
{% endif %}
</group>
