# --- Syslog listener options ---
forti_syslog_enable_udp: true
forti_syslog_enable_tcp: false
forti_syslog_udp_port: 514
forti_syslog_tcp_port: 5514

# Empty string means "all interfaces". Examples: "0.0.0.0", "::", "192.168.1.10"
forti_syslog_listen_address: ""

# Optional: restrict sender IPs. If empty, accept from anyone who can reach the port.
forti_syslog_allowed_senders: []

# --- Log storage (paths adjustable) ---
forti_log_dir: /var/log/fortinet
forti_log_filename: fortigate.log
forti_log_path: "{{ forti_log_dir }}/{{ forti_log_filename }}"

forti_log_dir_mode: "0750"
forti_log_file_mode: "0640"
forti_log_owner: root
forti_log_group: root

# --- Log retention / rotation (duration adjustable) ---
forti_logrotate_frequency: daily   # daily/weekly/monthly/yearly
forti_log_retention_days: 14       # used when frequency=daily

# logrotate "rotate" is "how many rotated files to keep"
# If you rotate daily, rotate == retention days.
forti_logrotate_rotate: "{{ forti_log_retention_days if forti_logrotate_frequency == 'daily' else 12 }}"

forti_logrotate_compress: true
forti_logrotate_delaycompress: true
forti_logrotate_copytruncate: true

# --- Config file locations ---
forti_rsyslog_conf_path: /etc/rsyslog.d/10-fortinet.conf
forti_logrotate_conf_path: /etc/logrotate.d/fortinet-syslog

# --- Service names ---
rsyslog_service_name: rsyslog

# --- Health checks ---
# Validate rsyslog service state, listener ports, and log path after configuration.
forti_rsyslog_healthcheck: true
# If true, fail the play on health check issues; if false, emit warnings only.
forti_rsyslog_healthcheck_fail: true
# Delay (seconds) before checking listeners after handler flush.
forti_rsyslog_healthcheck_delay: 2

# --- Wazuh integration ---
forti_wazuh_manage: true
forti_wazuh_ossec_conf_path: /var/ossec/etc/ossec.conf
forti_wazuh_manager_service_name: wazuh-manager
forti_wazuh_log_format: syslog

# The localfile block will be inserted before the closing ossec_config tag
forti_wazuh_insert_before_regex: "</ossec_config>"

# Fail the play if the ossec.conf path doesn't exist.
# Set to false if you want the role to configure rsyslog only.
forti_wazuh_fail_if_missing: true
